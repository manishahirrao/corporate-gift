// Copy this code into your Google Apps Script

function doPost(e) {
  try {
    const data = JSON.parse(e.postData.contents);
    const sheet = SpreadsheetApp.getActiveSpreadsheet().getActiveSheet();
    
    // Add new row with form data
    sheet.appendRow([
      data.name,
      data.email,
      data.company,
      data.phone,
      data.giftType,
      data.quantity,
      data.budget,
      data.occasion,
      data.message,
      data.submittedAt
    ]);
    
    // Return success response
    return ContentService.createTextOutput(JSON.stringify({
      status: 'success',
      message: 'Quote submitted successfully'
    })).setMimeType(ContentService.MimeType.JSON);
    
  } catch(error) {
    return ContentService.createTextOutput(JSON.stringify({
      status: 'error',
      message: error.toString()
    })).setMimeType(ContentService.MimeType.JSON);
  }
}
